#!/usr/bin/env bash

# If -f, then put computer to sleep.
# Otherwise, lock screen and turn off monitor.

if [[ $1 == -h ]]; then
  bin=${0##*/}
  echo "Usage: $bin [-f]"
  echo
  echo "  $bin       # put display to sleep"
  echo "  $bin -f    # put computer to sleep"
elif [[ $1 == -f ]]; then
  echo "Going to sleep..."
  systemctl suspend
else
  echo "Shutting my eyes..."
  playerctl --all-players pause &
  stellarium --full-screen yes --startup-script screensaver.ssc > /dev/null 2>&1 &
  stellarium_pid=$!
  echo "Stellarium pid is: $stellarium_pid, will terminate in 10 minutes and I turn off display."

  # Show screensaver for 120 seconds, then kill Stellarium.
  sleep 600 && kill $stellarium_pid && xset dpms force standby &
fi